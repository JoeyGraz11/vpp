function [Rw, Rwc, Rwk] = waveLookup(B, lA)
% Fig 5.18
% T1=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0;...
%     0.15,-0.0005,0.0023,-0.0086,-0.0015,0.0061,0.001,0.0001,0.0052;...
%     0.2,-0.0003,0.0059,-0.0064,0.007,0.0014,0.0013,0.0005,-0.002;...
%     0.25,-0.0002,-0.0156,0.0031,-0.0021,-0.007,0.0148,0.001,-0.0043;...
%     0.3,-0.0009,0.0016,0.0337,-0.0285,-0.0367,0.0218,0.0015,-0.0172;...
%     0.35,-0.0026,-0.0567,0.0446,-0.1091,-0.0707,0.0914,0.0021,-0.0078;...
%     0.4,-0.0064,-0.4034,-0.125,0.0273,-0.1341,0.3578,0.0045,0.1115;...
%     0.45,-0.0218,-0.5261,-0.2945,0.2485,-0.2428,0.6293,0.0081,0.2086;...
%     0.5,-0.0388,-0.5986,-0.3038,0.6033,-0.043,0.8332,0.0106,0.1336;...
%     0.55,-0.0347,-0.4764,-0.2361,0.8726,0.4219,0.899,0.0096,-0.2272;...
%     0.6,-0.0361,0.0037,0.296,0.9661,0.6123,0.7534,0.01,-0.3352;...
%     0.65,0.0008,0.3728,-0.3667,1.3957,1.0343,0.323,0.0072,-0.4632;...
%     0.7,0.0108,-0.1238,-0.2026,1.1282,1.1836,0.4973,0.0038,-0.4477;...
%     0.75,0.1023,0.7726,0.504,1.7867,2.1934,-1.5479,-0.0115,-0.0977];
% 
% % Fig 5.19
% T2=[0.0, 0.0, 0.0, 0.0, 0.0;...
%     0.2,-0.00104,0.00172,0.00117,-0.00008;...
%     0.25,-0.0055,0.00597,0.0039,-0.00009;...
%     0.3,-0.0111,0.01421,0.00069,0.00021;...
%     0.35,-0.00713,0.02632,-0.00232,0.00039;...
%     0.4,0.03581,0.08649,0.00999,0.00017;...
%     0.45,-0.0047,0.11592,-0.00064,0.00035;...
%     0.5,0.00553,0.07371,0.05991,-0.00114;...
%     0.55,0.04822,0.0066,0.07048,-0.00035;...
%     0.6,0.01021,0.14173,0.06409,-0.00192];
% 
% Fr1 = T1(:,1);
% a0 = spline(Fr1, T1(:,2), Fn);
% a1 = spline(Fr1, T1(:,3), Fn);
% a2 = spline(Fr1, T1(:,4), Fn);
% a3 = spline(Fr1, T1(:,5), Fn);
% a4 = spline(Fr1, T1(:,6), Fn);
% a5 = spline(Fr1, T1(:,7), Fn);
% a6 = spline(Fr1, T1(:,8), Fn);
% a7 = spline(Fr1, T1(:,9), Fn);
% 
% Fr2 = T2(:,1);
% A0 = spline(Fr2, T2(:,2), Fn);
% A1 = spline(Fr2, T2(:,3), Fn);
% A2 = spline(Fr2, T2(:,4), Fn);
% A3 = spline(Fr2, T2(:,5), Fn);

Fn = B.V / sqrt(0.7 * B.Lwl * 9.81);

a0 = ppval(lA(1), Fn);
a1 = ppval(lA(2), Fn);
a2 = ppval(lA(3), Fn);
a3 = ppval(lA(4), Fn);
a4 = ppval(lA(5), Fn);
a5 = ppval(lA(6), Fn);
a6 = ppval(lA(7), Fn);
a7 = ppval(lA(8), Fn);

A0 = ppval(lA(9), Fn);
A1 = ppval(lA(10), Fn);
A2 = ppval(lA(11), Fn);
A3 = ppval(lA(12), Fn);

LCB = B.LCBfpp;
Lwl = B.Lwl;
Cp = B.Cp;
LCF = B.LCFfpp;
Bwl = B.Bwl;
Vol = B.Vol;
disp = B.disp;

ratio1 = a0 + (a1*LCB/Lwl + a2*Cp + a3*Vol^(0.666)/B.Aw + a4*Bwl/Lwl + a5*LCB/LCF + a6*Bwl/B.Tc + a7*B.Cm)*Vol^(0.333)/Lwl;
Rwc = B.Vol*1025*9.81*ratio1;

ratio2 = A0 + A1*(B.T/Bwl) + A2*(B.Tc + abs(B.Tc - B.Tkeel/2))/Vol^(1/3) + A3*Vol/(B.Akeel*0.1);
Rwk = B.Akeel*0.1*9.81*1025*ratio2;

if isnan(Rwk)
    Rw = Rwc;
else
    Rw = Rwc + abs(Rwk);
end
end