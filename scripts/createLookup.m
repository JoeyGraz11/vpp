function [lC, lA] = createLookup()
% This function initializes curve fit splines for optimization
% Lookup values from PYD Table 7.1 a&b

% Table a
Ta=[0.0, 1.5, 1.5, 0.0, 1.3, 0.0;...
    27, 1.5, 1.5, 0.0, 1.3, 0.0;...
    50, 1.5, 0.5, 1.5, 1.4, 0.75;...
    80, 0.95, 0.3, 1.0, 1.0, 1.0;...
    100, 0.85, 0.0, 0.85, 0.8, 0.8;...
    180, 0.0, 0.0, 0.0, 0.0, 0.0];
% Table b
Tb=[0.0, 0.0, 0.0, 0.0, 0.0, 0.0;...
    27, 0.02, 0.02, 0.0, 0.02, 0.0;...
    50, 0.15, 0.25, 0.25, 0.15, 0.1;...
    80, 0.8, 0.15, 0.9, 0.75, 0.75;...
    100, 1.0, 0.0, 1.2, 1.0, 1.0;...
    180, 0.9, 0.0, 0.66, 0.8, 0.0];

x = Ta(:,1);

% Spline interp values
Clm = pchip(x, Ta(:, 2));
Clj = pchip(x, Ta(:, 3));
Cls = pchip(x, Ta(:, 4));
Clmiz = pchip(x, Ta(:, 5));
Clmizs = pchip(x, Ta(:, 6));

Cdm = pchip(x, Tb(:, 2));
Cdj = pchip(x, Tb(:, 3));
Cds = pchip(x, Tb(:, 4));
Cdmiz = pchip(x, Tb(:, 5));
Cdmizs = pchip(x, Tb(:, 6));

lC = [Clm, Clj, Cls, Clmiz, Clmizs, Cdm, Cdj, Cds, Cdmiz, Cdmizs];

% -----------------------------------------------------------------------------------
% Fig 5.18
T1=[0.00, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 0.00000;...
    0.15, -0.0005, 0.00230, -0.0086, -0.0015, 0.00610, 0.00100, 0.00010, 0.00520;...
    0.20, -0.0003, 0.00590, -0.0064, 0.00700, 0.00140, 0.00130, 0.00050, -0.0020;...
    0.25, -0.0002, -0.0156, 0.00310, -0.0021, -0.0070, 0.01480, 0.00100, -0.0043;...
    0.30, -0.0009, 0.00160, 0.03370, -0.0285, -0.0367, 0.02180, 0.00150, -0.0172;...
    0.35, -0.0026, -0.0567, 0.04460, -0.1091, -0.0707, 0.09140, 0.00210, -0.0078;...
    0.40, -0.0064, -0.4034, -0.1250, 0.02730, -0.1341, 0.35780, 0.00450, 0.11150;...
    0.45, -0.0218, -0.5261, -0.2945, 0.24850, -0.2428, 0.62930, 0.00810, 0.20860;...
    0.50, -0.0388, -0.5986, -0.3038, 0.60330, -0.0430, 0.83320, 0.01060, 0.13360;...
    0.55, -0.0347, -0.4764, -0.2361, 0.87260, 0.42190, 0.89900, 0.00960, -0.2272;...
    0.60, -0.0361, 0.00370, -0.2960, 0.96610, 0.61230, 0.75340, 0.01000, -0.3352;...
    0.65, 0.00080, 0.37280, -0.3667, 1.39570, 1.03430, 0.32300, 0.00720, -0.4632;...
    0.70, 0.01080, -0.1238, -0.2026, 1.12820, 1.18360, 0.49730, 0.00380, -0.4477;...
    0.75, 0.10230, 0.77260, 0.50400, 1.78670, 2.19340, -1.5479, -0.0115, -0.0977];...
    %0.90, 0.10230, 0.77260, 0.50400, 1.78670, 2.19340, -1.5479, -0.0115, -0.0977];

% Fig 5.19
T2=[0.0, 0.0, 0.0, 0.0, 0.0;...
    0.2,-0.00104,0.00172,0.00117,-0.00008;...
    0.25,-0.0055,0.00597,0.0039,-0.00009;...
    0.3,-0.0111,0.01421,0.00069,0.00021;...
    0.35,-0.00713,0.02632,-0.00232,0.00039;...
    0.4,-0.03581,0.08649,0.00999,0.00017;...
    0.45,-0.0047,0.11592,-0.00064,0.00035;...
    0.5,0.00553,0.07371,0.05991,-0.00114;...
    0.55,0.04822,0.0066,0.07048,-0.00035;...
    0.6,0.01021,0.14173,0.06409,-0.00192];

% Fr1 = T1(:,1);
% a0 = spline(Fr1, T1(:,2));
% a1 = spline(Fr1, T1(:,3));
% a2 = spline(Fr1, T1(:,4));
% a3 = spline(Fr1, T1(:,5));
% a4 = spline(Fr1, T1(:,6));
% a5 = spline(Fr1, T1(:,7));
% a6 = spline(Fr1, T1(:,8));
% a7 = spline(Fr1, T1(:,9));
% 
% Fr2 = T2(:,1);
% A0 = spline(Fr2, T2(:,2));
% A1 = spline(Fr2, T2(:,3));
% A2 = spline(Fr2, T2(:,4));
% A3 = spline(Fr2, T2(:,5));

Fr1 = T1(:,1);
a0 = pchip(Fr1, T1(:,2));
a1 = pchip(Fr1, T1(:,3));
a2 = pchip(Fr1, T1(:,4));
a3 = pchip(Fr1, T1(:,5));
a4 = pchip(Fr1, T1(:,6));
a5 = pchip(Fr1, T1(:,7));
a6 = pchip(Fr1, T1(:,8));
a7 = pchip(Fr1, T1(:,9));

Fr2 = T2(:,1);
A0 = pchip(Fr2, T2(:,2));
A1 = pchip(Fr2, T2(:,3));
A2 = pchip(Fr2, T2(:,4));
A3 = pchip(Fr2, T2(:,5));

%Debug
% x = linspace(0.0, 0.8);
% plot(x, ppval(a7, x), Fr1, T1(:,9), 'o')

lA = [a0, a1, a2, a3, a4, a5, a6, a7, A0, A1, A2, A3];
end